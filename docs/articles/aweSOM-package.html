<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>aweSOM package description • aweSOM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="aweSOM package description">
<meta property="og:description" content="aweSOM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aweSOM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/aweSOM-package.html">Vignette</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="aweSOM-package_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="aweSOM-package_files/d3-3.5.14/d3.min.js"></script><script src="aweSOM-package_files/aweSOMwidget-binding-0.2.1/aweSOMwidget.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>aweSOM package description</h1>
            
      
      
      <div class="hidden name"><code>aweSOM-package.Rmd</code></div>

    </div>

    
    
<p><strong>aweSOM</strong> is an R package offering a set of tools to explore and analyze datasets with Self-Organizing Maps (also known as <a href="https://en.wikipedia.org/wiki/Self-organizing_map">Kohonen maps</a>), a form of artificial neural network originally created by <a href="https://en.wikipedia.org/wiki/Teuvo_Kohonen">Teuvo Kohonen</a> in the 1980s. The package introduces interactive plots, making analysis of the SOM easier.</p>
<p><strong>aweSOM</strong> provides a variety of functions to analyze and visualize SOMs. They can be used either through the web-based interface (called by <code><a href="../reference/aweSOM.html">aweSOM()</a></code>) or through command-line functions. The package relies on the <code>kohonen</code> package for the training of SOMs.</p>
<p>This vignette details some of the most important functions of the aweSOM package, along with the workflow of training a SOM, assessing its quality measures and visualizing the SOM as well superclusters within it.</p>
<div id="creating-a-dataset-and-training-a-self-organizig-map" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-a-dataset-and-training-a-self-organizig-map" class="anchor"></a>Creating a dataset and training a Self-Organizig Map</h2>
<p>For the purpose of this example, the iris dataset is used to train a 4x4 hexagonal SOM.</p>
<p>After selecting and pre-processing the training data (here by scaling each variable), the <code>somInit</code> function is used to initialize the map’s prototypes. By default, this is done by initializing the grid on the first two principal components (PCA), but other schemes are available.</p>
<p>The training data, initial prototypes and other parameters are then passed to the <code><a href="https://rdrr.io/pkg/kohonen/man/supersom.html">kohonen::som</a></code> function for training.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ok.data</span> <span class="op">&lt;-</span> <span class="va">iris</span>
<span class="co">## Select variables</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">ok.data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sepal.Length"</span>, <span class="st">"Sepal.Width"</span>,  <span class="st">"Petal.Length"</span>, <span class="st">"Petal.Width"</span> <span class="op">)</span><span class="op">]</span>
<span class="co">### Scale training data</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="co">### Initialization (PCA grid)</span>
<span class="va">init</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/somInit.html">somInit</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>
<span class="co">## Train SOM</span>
<span class="va">ok.som</span> <span class="op">&lt;-</span> <span class="fu">kohonen</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kohonen/man/supersom.html">som</a></span><span class="op">(</span><span class="va">dat</span>, grid <span class="op">=</span> <span class="fu">kohonen</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kohonen/man/unit.distances.html">somgrid</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="st">'hexagonal'</span><span class="op">)</span>, rlen <span class="op">=</span> <span class="fl">100</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.01</span><span class="op">)</span>,
                       radius <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6.08</span>,<span class="op">-</span><span class="fl">6.08</span><span class="op">)</span>, init <span class="op">=</span> <span class="va">init</span>, dist.fcts <span class="op">=</span> <span class="st">'sumofsquares'</span><span class="op">)</span></code></pre></div>
</div>
<div id="assessing-the-quality-of-the-map" class="section level2">
<h2 class="hasAnchor">
<a href="#assessing-the-quality-of-the-map" class="anchor"></a>Assessing the Quality of the Map</h2>
<p>The <code>somQuality</code> function can be used to assess the quality of a SOM object created by <code><a href="https://rdrr.io/pkg/kohonen/man/supersom.html">kohonen::som</a></code>, according to several measures.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">aweSOM</span><span class="fu">::</span><span class="fu"><a href="../reference/somQuality.html">somQuality</a></span><span class="op">(</span>ok.som <span class="op">=</span> <span class="va">ok.som</span>, traindat <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ## Quality measures:</span>
<span class="co">#&gt;  * Quantization error     :  0.2424712 </span>
<span class="co">#&gt;  * (% explained variance) :  93.9 </span>
<span class="co">#&gt;  * Topographic error      :  0.28 </span>
<span class="co">#&gt;  * Kaski-Lagus error      :  1.689054 </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; ## Number of obs. per map cell:</span>
<span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 </span>
<span class="co">#&gt;  5 11 11  5 16  0 13 14  7 13  9  7 13 14  9  3</span></code></pre></div>
<ul>
<li><p><strong>Percentage of explained variance</strong>: Similar to other clustering methods, the share of total variance that is explained by the clustering.</p></li>
<li><p><strong>Quantization error</strong>: Average distance between the data points and the map’s prototypes to which they are mapped.</p></li>
<li><p><strong>Topographic error</strong>: Share of observations for which the best-matching node is not a neighbor of the second-best matching node on the map. 0 indicates excellent topographic representation (all best and second-best matching nodes are neighbours), 1 is the maximum error (best and second-best nodes are never neighbours).</p></li>
<li><p><strong>Kaski-Lagus error</strong>: Combines the quantization error and the topographic error</p></li>
</ul>
</div>
<div id="visualizing-som-with-awesom" class="section level2">
<h2 class="hasAnchor">
<a href="#visualizing-som-with-awesom" class="anchor"></a>Visualizing SOM with aweSOM</h2>
<p>aweSOM provides multiple types of interactive and static visualizations for SOM.</p>
<p>They can be called using the aweSOM shiny widget (launched using aweSOM::aweSOM()), or directly from the command line.</p>
<div id="awesomplot" class="section level3">
<h3 class="hasAnchor">
<a href="#awesomplot" class="anchor"></a>aweSOMplot</h3>
<p>aweSOMplot creates a variety of different interactive SOM visualizations. Using the <em>graphType</em> argument to the function, one the following types of plots can be created:</p>
<ul>
<li>
<strong>Hitmap</strong> or <strong>population map</strong>: visualizes the number of observation per cell using respectively sized hexagons/rectangles.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">aweSOM</span><span class="fu">::</span><span class="fu"><a href="../reference/aweSOMplot.html">aweSOMplot</a></span><span class="op">(</span>ok.som <span class="op">=</span> <span class="va">ok.som</span>, ok.sc <span class="op">=</span> <span class="va">superclasses</span>, ok.data <span class="op">=</span> <span class="va">ok.data</span>,
                   graphType <span class="op">=</span> <span class="st">'Hitmap'</span>, 
                   plotSize <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></code></pre></div>
<h4 id="cell-info"></h4>
<h4 id="plot-message"></h4>
<div id="theWidget" class="aweSOMwidget html-widget" style="width:400px;height:400px;display:block; margin:auto; margin-top:5px; margin-bottom:5px;"></div>
<p id="plot-names"></p>
<svg id="awesom_legend_svg" width="100%"></svg><script type="application/json" data-for="theWidget">{"x":{"plotType":"Hitmap","sizeInfo":400,"gridInfo":{"nbLines":4,"nbColumns":4,"topology":"hexagonal"},"superclass":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"superclassColor":["#8DD3C7"],"cellNames":["58, 61, 94, 99, 107","54, 63, 69, 70, 80, 81, 82, 88, 90, 93, 120","73, 84, 104, 109, 112, 124, 127, 129, 133, 135, 147","102, 114, 115, 122, 143","2, 3, 4, 9, 10, 13, 14, 26, 30, 31, 35, 39, 42, 43, 46, 48","","55, 62, 64, 72, 74, 75, 79, 92, 98, 128, 134, 139, 150","103, 105, 113, 117, 121, 125, 126, 140, 141, 142, 144, 145, 146, 148","5, 7, 12, 23, 25, 38, 41","56, 60, 65, 67, 68, 83, 85, 89, 91, 95, 96, 97, 100","51, 52, 53, 59, 66, 76, 77, 78, 87","106, 108, 119, 123, 130, 131, 136","6, 11, 15, 16, 17, 19, 20, 22, 33, 34, 45, 47, 49","1, 8, 18, 21, 24, 27, 28, 29, 32, 36, 37, 40, 44, 50","57, 71, 86, 101, 111, 116, 137, 138, 149","110, 118, 132"],"cellPop":[5,11,11,5,16,0,13,14,7,13,9,7,13,14,9,3],"showAxes":null,"normalizedValues":[0.503115294937453,0.746240577829965,0.746240577829965,0.503115294937453,0.9,0,0.811249036979398,0.841872912024137,0.595294044989533,0.811249036979398,0.675,0.595294044989533,0.811249036979398,0.841872912024137,0.675,0.389711431702997],"realValues":[5,11,11,5,16,0,13,14,7,13,9,7,13,14,9,3]},"evals":[],"jsHooks":[]}</script><p>The <strong>radar plot</strong> displays the mean value for each of the variables, per cell</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">aweSOM</span><span class="fu">::</span><span class="fu"><a href="../reference/aweSOMplot.html">aweSOMplot</a></span><span class="op">(</span>ok.som <span class="op">=</span> <span class="va">ok.som</span>, ok.sc <span class="op">=</span> <span class="va">superclasses</span>, ok.data <span class="op">=</span> <span class="va">ok.data</span>,
                   graphType <span class="op">=</span> <span class="st">'Radar'</span>,  
                   plotVarMult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sepal.Length"</span>, <span class="st">"Sepal.Width"</span>,  
                                   <span class="st">"Petal.Length"</span>, <span class="st">"Petal.Width"</span><span class="op">)</span>,  
                   plotSize <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></code></pre></div>
<h4 id="cell-info"></h4>
<h4 id="plot-message"></h4>
<div id="theWidget" class="aweSOMwidget html-widget" style="width:400px;height:400px;display:block; margin:auto; margin-top:5px; margin-bottom:5px;"></div>
<p id="plot-names"></p>
<svg id="awesom_legend_svg" width="100%"></svg><script type="application/json" data-for="theWidget">{"x":{"plotType":"Radar","sizeInfo":400,"gridInfo":{"nbLines":4,"nbColumns":4,"topology":"hexagonal"},"superclass":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"superclassColor":["#8DD3C7"],"cellNames":["58, 61, 94, 99, 107","54, 63, 69, 70, 80, 81, 82, 88, 90, 93, 120","73, 84, 104, 109, 112, 124, 127, 129, 133, 135, 147","102, 114, 115, 122, 143","2, 3, 4, 9, 10, 13, 14, 26, 30, 31, 35, 39, 42, 43, 46, 48","","55, 62, 64, 72, 74, 75, 79, 92, 98, 128, 134, 139, 150","103, 105, 113, 117, 121, 125, 126, 140, 141, 142, 144, 145, 146, 148","5, 7, 12, 23, 25, 38, 41","56, 60, 65, 67, 68, 83, 85, 89, 91, 95, 96, 97, 100","51, 52, 53, 59, 66, 76, 77, 78, 87","106, 108, 119, 123, 130, 131, 136","6, 11, 15, 16, 17, 19, 20, 22, 33, 34, 45, 47, 49","1, 8, 18, 21, 24, 27, 28, 29, 32, 36, 37, 40, 44, 50","57, 71, 86, 101, 111, 116, 137, 138, 149","110, 118, 132"],"cellPop":[5,11,11,5,16,0,13,14,7,13,9,7,13,14,9,3],"showAxes":null,"nVars":4,"labelColor":["#440154","#31688E","#35B779","#FDE725"],"label":["Sepal.Length","Sepal.Width","Petal.Length","Petal.Width"],"normalizedValues":[[0.145496417604913,0.05,0.43024864648085,0.476385483079941],[0.391760491299898,0.074107142857143,0.530048125125326,0.498013732221677],[0.553582395087001,0.246301020408163,0.749859635051133,0.758876900441393],[0.378863868986694,0.256632653061225,0.704561860838179,0.864811181951937],[0.05,0.443176020408163,0.05,0.05],[null,null,null,null],[0.4989252814739,0.376020408163265,0.625155404050531,0.619838155958803],[0.697901740020471,0.490242346938776,0.803098054942851,0.919543894065719],[0.0945240532241557,0.715816326530612,0.0528875075195508,0.0588278567925454],[0.338331627430911,0.331823979591837,0.547373170242631,0.534649337910741],[0.677021494370522,0.454081632653061,0.637246841788651,0.607037763609613],[0.923592630501536,0.354783163265306,0.942239823541207,0.847155468366847],[0.264943705220061,0.95,0.069851614196912,0.0901667484060814],[0.197697031729785,0.662436224489796,0.0619109685181472,0.0906081412457087],[0.537308085977482,0.588392857142857,0.735422097453379,0.861721432074546],[0.95,0.849553571428572,0.95,0.95]],"realValues":[[4.98,2.34,3.52,1.16],[5.782,2.382,4.073,1.209],[6.309,2.682,5.291,1.8],[5.74,2.7,5.04,2.04],[4.669,3.025,1.413,0.194],[null,null,null,null],[6.131,2.908,4.6,1.485],[6.779,3.107,5.586,2.164],[4.814,3.5,1.429,0.214],[5.608,2.831,4.169,1.292],[6.711,3.044,4.667,1.456],[7.514,2.871,6.357,2],[5.369,3.908,1.523,0.285],[5.15,3.407,1.479,0.286],[6.256,3.278,5.211,2.033],[7.6,3.733,6.4,2.233]],"isCatBarplot":false,"showSuperclass":true},"evals":[],"jsHooks":[]}</script><p>This can also be represented with barplots when the number of variables is limited.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">aweSOM</span><span class="fu">::</span><span class="fu"><a href="../reference/aweSOMplot.html">aweSOMplot</a></span><span class="op">(</span>ok.som <span class="op">=</span> <span class="va">ok.som</span>, ok.sc <span class="op">=</span> <span class="va">superclasses</span>, ok.data <span class="op">=</span> <span class="va">ok.data</span>,
                   graphType <span class="op">=</span> <span class="st">'Barplot'</span>,  
                   plotVarMult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sepal.Length"</span>, <span class="st">"Sepal.Width"</span>,  
                                   <span class="st">"Petal.Length"</span>, <span class="st">"Petal.Width"</span><span class="op">)</span>,  
                   plotSize <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></code></pre></div>
<h4 id="cell-info"></h4>
<h4 id="plot-message"></h4>
<div id="theWidget" class="aweSOMwidget html-widget" style="width:400px;height:400px;display:block; margin:auto; margin-top:5px; margin-bottom:5px;"></div>
<p id="plot-names"></p>
<svg id="awesom_legend_svg" width="100%"></svg><script type="application/json" data-for="theWidget">{"x":{"plotType":"Barplot","sizeInfo":400,"gridInfo":{"nbLines":4,"nbColumns":4,"topology":"hexagonal"},"superclass":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"superclassColor":["#8DD3C7"],"cellNames":["58, 61, 94, 99, 107","54, 63, 69, 70, 80, 81, 82, 88, 90, 93, 120","73, 84, 104, 109, 112, 124, 127, 129, 133, 135, 147","102, 114, 115, 122, 143","2, 3, 4, 9, 10, 13, 14, 26, 30, 31, 35, 39, 42, 43, 46, 48","","55, 62, 64, 72, 74, 75, 79, 92, 98, 128, 134, 139, 150","103, 105, 113, 117, 121, 125, 126, 140, 141, 142, 144, 145, 146, 148","5, 7, 12, 23, 25, 38, 41","56, 60, 65, 67, 68, 83, 85, 89, 91, 95, 96, 97, 100","51, 52, 53, 59, 66, 76, 77, 78, 87","106, 108, 119, 123, 130, 131, 136","6, 11, 15, 16, 17, 19, 20, 22, 33, 34, 45, 47, 49","1, 8, 18, 21, 24, 27, 28, 29, 32, 36, 37, 40, 44, 50","57, 71, 86, 101, 111, 116, 137, 138, 149","110, 118, 132"],"cellPop":[5,11,11,5,16,0,13,14,7,13,9,7,13,14,9,3],"showAxes":null,"nVars":4,"labelColor":["#440154","#31688E","#35B779","#FDE725"],"label":["Sepal.Length","Sepal.Width","Petal.Length","Petal.Width"],"normalizedValues":[[0.145496417604913,0.05,0.43024864648085,0.476385483079941],[0.391760491299898,0.074107142857143,0.530048125125326,0.498013732221677],[0.553582395087001,0.246301020408163,0.749859635051133,0.758876900441393],[0.378863868986694,0.256632653061225,0.704561860838179,0.864811181951937],[0.05,0.443176020408163,0.05,0.05],[null,null,null,null],[0.4989252814739,0.376020408163265,0.625155404050531,0.619838155958803],[0.697901740020471,0.490242346938776,0.803098054942851,0.919543894065719],[0.0945240532241557,0.715816326530612,0.0528875075195508,0.0588278567925454],[0.338331627430911,0.331823979591837,0.547373170242631,0.534649337910741],[0.677021494370522,0.454081632653061,0.637246841788651,0.607037763609613],[0.923592630501536,0.354783163265306,0.942239823541207,0.847155468366847],[0.264943705220061,0.95,0.069851614196912,0.0901667484060814],[0.197697031729785,0.662436224489796,0.0619109685181472,0.0906081412457087],[0.537308085977482,0.588392857142857,0.735422097453379,0.861721432074546],[0.95,0.849553571428572,0.95,0.95]],"realValues":[[4.98,2.34,3.52,1.16],[5.782,2.382,4.073,1.209],[6.309,2.682,5.291,1.8],[5.74,2.7,5.04,2.04],[4.669,3.025,1.413,0.194],[null,null,null,null],[6.131,2.908,4.6,1.485],[6.779,3.107,5.586,2.164],[4.814,3.5,1.429,0.214],[5.608,2.831,4.169,1.292],[6.711,3.044,4.667,1.456],[7.514,2.871,6.357,2],[5.369,3.908,1.523,0.285],[5.15,3.407,1.479,0.286],[6.256,3.278,5.211,2.033],[7.6,3.733,6.4,2.233]],"isCatBarplot":false,"showSuperclass":true},"evals":[],"jsHooks":[]}</script><p>Other information can also be plotted:</p>
<ul>
<li>
<strong>Boxplot</strong> displays the quartile distribution of values for each cell.</li>
<li>
<strong>Star</strong> WHAT DOES IT DO EXACTLY?</li>
<li>
<strong>Heat</strong> WHAT DOES IT DO EXACTLY?</li>
</ul>
<p>Categorical variables, or variables that were not taken into account in the creation of the map, can also be plotted.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">aweSOM</span><span class="fu">::</span><span class="fu"><a href="../reference/aweSOMplot.html">aweSOMplot</a></span><span class="op">(</span>ok.som <span class="op">=</span> <span class="va">ok.som</span>, ok.sc <span class="op">=</span> <span class="va">superclasses</span>, ok.data <span class="op">=</span> <span class="va">ok.data</span>,
                   graphType <span class="op">=</span> <span class="st">'Camembert'</span>, 
                   plotNames <span class="op">=</span> <span class="st">'Species'</span>,
                   plotVarOne <span class="op">=</span> <span class="st">'Species'</span>,
                   plotSize <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></code></pre></div>
<h4 id="cell-info"></h4>
<h4 id="plot-message"></h4>
<div id="theWidget" class="aweSOMwidget html-widget" style="width:400px;height:400px;display:block; margin:auto; margin-top:5px; margin-bottom:5px;"></div>
<p id="plot-names"></p>
<svg id="awesom_legend_svg" width="100%"></svg><script type="application/json" data-for="theWidget">{"x":{"plotType":"Camembert","sizeInfo":400,"gridInfo":{"nbLines":4,"nbColumns":4,"topology":"hexagonal"},"superclass":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"superclassColor":["#8DD3C7"],"cellNames":["versicolor, versicolor, versicolor, versicolor, virginica","versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, virginica","versicolor, versicolor, virginica, virginica, virginica, virginica, virginica, virginica, virginica, virginica, virginica","virginica, virginica, virginica, virginica, virginica","setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa","","versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, virginica, virginica, virginica, virginica","virginica, virginica, virginica, virginica, virginica, virginica, virginica, virginica, virginica, virginica, virginica, virginica, virginica, virginica","setosa, setosa, setosa, setosa, setosa, setosa, setosa","versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, versicolor","versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, versicolor, versicolor","virginica, virginica, virginica, virginica, virginica, virginica, virginica","setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa","setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa","versicolor, versicolor, versicolor, virginica, virginica, virginica, virginica, virginica, virginica","virginica, virginica, virginica"],"cellPop":[5,11,11,5,16,0,13,14,7,13,9,7,13,14,9,3],"showAxes":null,"nVars":3,"label":["setosa","versicolor","virginica"],"labelColor":["#440154","#21908C","#FDE725"],"normalizedSize":[0.503115294937453,0.746240577829965,0.746240577829965,0.503115294937453,0.9,0,0.811249036979398,0.841872912024137,0.595294044989533,0.811249036979398,0.675,0.595294044989533,0.811249036979398,0.841872912024137,0.675,0.389711431702997],"realSize":[5,11,11,5,16,0,13,14,7,13,9,7,13,14,9,3],"normalizedValues":[[0,0.8,0.2],[0,0.909090909090909,0.0909090909090909],[0,0.181818181818182,0.818181818181818],[0,0,1],[1,0,0],[0.333333333333333,0.333333333333333,0.333333333333333],[0,0.692307692307692,0.307692307692308],[0,0,1],[1,0,0],[0,1,0],[0,1,0],[0,0,1],[1,0,0],[1,0,0],[0,0.333333333333333,0.666666666666667],[0,0,1]],"realValues":[[0,4,1],[0,10,1],[0,2,9],[0,0,5],[16,0,0],[0,0,0],[0,9,4],[0,0,14],[7,0,0],[0,13,0],[0,9,0],[0,0,7],[13,0,0],[14,0,0],[0,3,6],[0,0,3]]},"evals":[],"jsHooks":[]}</script><p>In this case, we plot the <em>Species</em>, which returns the percentage of species grouped in each cell. One can see that the algorithm did cluster the species together with quasi-perfection</p>
<p>Further options are available to explore the dataset, and several arguments can be specified</p>
<ul>
<li>
<em>plotNames</em>:</li>
<li><em>constrast</em></li>
<li><em>average_format</em></li>
<li>
<em>plotVarMult</em>:</li>
<li>
<em>plotOutliers</em>:</li>
<li>
<em>plotEqualSize</em>:</li>
<li>
<em>plotSize</em>:</li>
<li>
<em>palsc</em>:</li>
<li>
<em>palplot</em>:</li>
<li>
<em>plotRevPal</em>:</li>
</ul>
<p>Additionally, <em>omitRows</em> can be used an argument to omit certain rows from the visualization.</p>
</div>
<div id="awesomsmoothdist" class="section level3">
<h3 class="hasAnchor">
<a href="#awesomsmoothdist" class="anchor"></a>aweSOMsmoothdist</h3>
</div>
</div>
<div id="superclasses-of-som" class="section level2">
<h2 class="hasAnchor">
<a href="#superclasses-of-som" class="anchor"></a>Superclasses of SOM</h2>
<p>SOM maps can be further clustered into superclasses, groups of cells with similar profiles. To do so, classic clustering algorithms are used.</p>
<p>PAM clustering on the SOM cells can be achieved using the following code, or through the shiny app.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">superclust_pam</span> <span class="op">&lt;-</span> <span class="fu">cluster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cluster/man/pam.html">pam</a></span><span class="op">(</span><span class="va">ok.som</span><span class="op">$</span><span class="va">codes</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>
<span class="va">superclasses_pam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="va">superclust_pam</span><span class="op">$</span><span class="va">clustering</span><span class="op">)</span></code></pre></div>
<p>Hierarchical clustering on the SOM cells can be achieved using the following code, or through the shiny app.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">superclust_hclust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">ok.som</span><span class="op">$</span><span class="va">codes</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">'ward.D2'</span><span class="op">)</span>
<span class="va">superclasses_hclust</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="va">superclust_hclust</span><span class="op">$</span><span class="va">clustering</span><span class="op">)</span></code></pre></div>
<div id="quality-of-superclass-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#quality-of-superclass-clustering" class="anchor"></a>Quality of superclass clustering</h3>
<p>aweSOM provides inbuilt functions to create three different plots that allow assessing the quality of both types of clustering: <em>aweSOMdendrogram</em>, <em>aweSOMscreeplot</em>, and <em>aweSOMsilhouette</em>.</p>
</div>
<div id="awesomdendrogram" class="section level3">
<h3 class="hasAnchor">
<a href="#awesomdendrogram" class="anchor"></a>aweSOMdendrogram</h3>
<p>aweSOMdendrogram returns a dendogram for hierarchical clustering performed on an SOM object. For the example below, the hierarchical clustering performed in the previous section is used and 2 superclasses are visualized. This function is only valid for hierarchical clustering.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">aweSOM</span><span class="fu">::</span><span class="fu"><a href="../reference/aweSOMdendrogram.html">aweSOMdendrogram</a></span><span class="op">(</span>ok.som <span class="op">=</span> <span class="va">ok.som</span>, ok.hclust <span class="op">=</span> <span class="va">superclust_hclust</span>, 
                         input_kohSuperclass <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="aweSOM-package_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
</div>
<div id="awesomscreeplot" class="section level3">
<h3 class="hasAnchor">
<a href="#awesomscreeplot" class="anchor"></a>aweSOMscreeplot</h3>
<p>aweSOMscreeplot [tbd] JULIEN TU PEUX EXPLIQUER?</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">aweSOM</span><span class="fu">::</span><span class="fu"><a href="../reference/aweSOMscreeplot.html">aweSOMscreeplot</a></span><span class="op">(</span>ok.som <span class="op">=</span> <span class="va">ok.som</span>, method <span class="op">=</span> <span class="st">'hierarchical'</span>, 
                        hmethod <span class="op">=</span> <span class="st">'ward.D2'</span>, nclass <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="aweSOM-package_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
</div>
<div id="awesomsilhouette" class="section level3">
<h3 class="hasAnchor">
<a href="#awesomsilhouette" class="anchor"></a>aweSOMsilhouette</h3>
<p>aweSOMsilhouette returns a silhouette for PAM clustering performed on an SOM object. For the example below, the PAM clustering is the same as the one performed in the previous section. This function is only valid for PAM clustering.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">aweSOM</span><span class="fu">::</span><span class="fu"><a href="../reference/aweSOMsilhouette.html">aweSOMsilhouette</a></span><span class="op">(</span><span class="va">ok.som</span>, <span class="va">superclasses_pam</span><span class="op">)</span></code></pre></div>
<p><img src="aweSOM-package_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Julien Boelaert, Etienne Ollion, Jan Sodoge, Mohamed Sodoge, Otmane Naji, Samuel Hym.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
